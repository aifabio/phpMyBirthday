BEGIN:VCALENDAR
PRODID:-//Mayflower GmbH//Birthday Calendar 1.0 MIMEDIR//DE
VERSION:2.0
METHOD:PUBLISH
X-MS-OLK-FORCEINSPECTOROPEN:TRUE
BEGIN:VTIMEZONE
TZID:Amsterdam\, Berlin\, Bern\, Rom\, Stockholm\, Wien
BEGIN:STANDARD
DTSTART:16011028T030000
RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=10
TZOFFSETFROM:+0200
TZOFFSETTO:+0100
END:STANDARD
BEGIN:DAYLIGHT
DTSTART:16010325T020000
RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=3
TZOFFSETFROM:+0100
TZOFFSETTO:+0200
END:DAYLIGHT
END:VTIMEZONE
<?php foreach ($this->users as $user) { ?>
BEGIN:VEVENT
CLASS:PUBLIC
DESCRIPTION:Geburtstag <?php echo $user['firstName'];?> <?php echo $user['secondName'] . "\n";?>
DTEND;VALUE=DATE:<?php echo $user['nextDate'] . "\n"; ?>
DTSTAMP:20090516T094800Z
DTSTART;VALUE=DATE:<?php echo $user['birthDate'] . "\n"; ?>
LAST-MODIFIED:20090516T095203Z
LOCATION:Mayflower Office
PRIORITY:5
RRULE:FREQ=YEARLY;INTERVAL=1;BYMONTHDAY=<?php echo $user['birthDay'];?>;BYMONTH=<?php echo $user['birthMonth'] . "\n";?>
SUMMARY;LANGUAGE=de:Geburtstag <?php echo $user['firstName'];?> <?php echo $user['secondName'] . "\n";?>
TRANSP:TRANSPARENT
UID:<?php echo $user['id'] . '_' . $this->timeStamp . '@mayflower.de' . "\n"; ?>
X-MICROSOFT-CDO-BUSYSTATUS:FREE
X-MICROSOFT-CDO-IMPORTANCE:1
X-MICROSOFT-DISALLOW-COUNTER:FALSE
X-MS-OLK-ALLOWEXTERNCHECK:TRUE
X-MS-OLK-AUTOFILLLOCATION:FALSE
X-MS-OLK-CONFTYPE:0
END:VEVENT
<?php } ?>
END:VCALENDAR